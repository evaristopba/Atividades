<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desafio de L√≥gica: As Regi√µes do Brasil</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; display: flex; flex-wrap: wrap; gap: 30px; padding: 20px; background-color: #f4f7f9; }
        .game-container { flex: 3; min-width: 600px; }
        .pistas-container { flex: 2; min-width: 300px; background-color: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        table { width: 100%; border-collapse: collapse; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        th, td { border: 1px solid #dfe6e9; padding: 12px; text-align: left; vertical-align: middle; }
        th { background-color: #f2f2f2; font-weight: bold; }
        select { width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #b2bec3; background-color: #fff; transition: background-color 0.3s, border-color 0.3s; }
        button { background-color: #d63031; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 16px; margin-right: 10px; margin-top: 15px; }
        button:hover { background-color: #b01e1f; }
        h1, h3 { color: #2d3436; }
        h3 { border-bottom: 2px solid #0984e3; padding-bottom: 5px; margin-top: 0;}
        .pistas-container ul { list-style: none; padding-left: 0; margin: 0; }
        .pistas-container li { margin-bottom: 12px; line-height: 1.5; padding: 8px; border-radius: 4px; transition: all 0.4s ease; border-left: 5px solid #dfe6e9;}
        .pista-satisfeita { color: #555; border-left-color: #27ae60; background-color: #f0fff4; text-decoration: line-through; }
        .pista-satisfeita::before { content: '‚úì '; color: #27ae60; font-weight: bold;}
        .select-correct { background-color: #c8e6c9 !important; border-color: #2e7d32 !important; }
        .select-incorrect { background-color: #ffcdd2 !important; border-color: #c62828 !important; }
        .timer { font-size: 2em; font-weight: bold; color: #e74c3c; text-align: center; margin: 10px 0 20px 0; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); display: none; justify-content: center; align-items: center; z-index: 1000; padding: 20px; box-sizing: border-box; }
        .modal-content { background: white; padding: 20px 40px; border-radius: 10px; max-width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 5px 15px rgba(0,0,0,0.3); text-align: center; }
        .modal-content h2 { color: #2c3e50; }
        .modal-content h4 { color: #3498db; margin-top: 20px; }
        .modal-content p { line-height: 1.6; text-align: left;}
        .modal-close-btn { display: block; margin: 20px auto 0; padding: 10px 30px; font-size: 16px; font-weight: bold; cursor: pointer; background-color: #27ae60; color: white; border: none; border-radius: 5px; }
        .modal-close-btn:hover { background-color: #229954; }
        #results-gallery { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; margin-top: 20px; }
        .gallery-item { width: 18%; min-width: 150px; background-color: #f9f9f9; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.1); display: flex; flex-direction: column; }
        .prato-titulo { padding: 8px; margin: 0; font-size: 0.9em; font-weight: bold; color: #333; background-color: #f7f7f7; border-bottom: 1px solid #eee; }
        .gallery-item img { width: 100%; height: 120px; object-fit: cover; }
        .gallery-item figcaption { padding: 10px; font-size: 0.85em; color: #555; display: flex; align-items: center; justify-content: center; gap: 8px; margin-top: auto; flex-wrap: wrap; }
        .bandeira-estado { height: 20px; width: auto; border: 1px solid #ccc; }
        .caption-text { width: 100%; text-align: center; line-height: 1.2; }
        footer { width: 100%; text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #dfe6e9; font-size: 0.8em; color: #666; }
        footer a { color: #0984e3; text-decoration: none; }
        footer a:hover { text-decoration: underline; }
        @media (max-width: 900px) {
            body { flex-direction: column; padding: 10px; gap: 20px; }
            .game-container, .pistas-container { min-width: 100%; flex-basis: auto; box-sizing: border-box; }
            .gallery-item { width: 45%; }
            h1 { font-size: 1.5em; }
        }
    </style>
</head>
<body>
    <div id="intro-modal" class="modal-overlay">
        <div class="modal-content">
            <h2>Bem-vindo ao Desafio das Regi√µes Brasileiras!</h2>
            <p>Sua miss√£o √© usar as pistas para preencher o mapa do Brasil. Este guia r√°pido lhe dar√° o conhecimento b√°sico para come√ßar. Boa sorte!</p>
            <h4>üå≥ Regi√£o Norte</h4><p>A maior regi√£o do pa√≠s, dominada pela Floresta Amaz√¥nica. Sua economia √© forte no extrativismo e sua culin√°ria usa ingredientes √∫nicos como no Tacac√°.</p>
            <h4>‚òÄÔ∏è Regi√£o Nordeste</h4><p>O ber√ßo cultural do Brasil, com um vasto litoral que impulsiona o Turismo. √â famosa por pratos de sabor forte como o Acaraj√© e pela Caatinga no sert√£o.</p>
            <h4>üå± Regi√£o Centro-Oeste</h4><p>O cora√ß√£o do Agroneg√≥cio brasileiro, com o bioma Cerrado e a plan√≠cie do Pantanal. A culin√°ria reflete a terra, como no Arroz com Pequi.</p>
            <h4>üè≠ Regi√£o Sudeste</h4><p>A pot√™ncia econ√¥mica e industrial, e a mais populosa. Abriga metr√≥poles como S√£o Paulo e tesouros da Mata Atl√¢ntica.</p>
            <h4>‚ùÑÔ∏è Regi√£o Sul</h4><p>De clima mais frio e forte influ√™ncia europeia, tem a Agroind√∫stria como destaque e o Pampa como bioma caracter√≠stico.</p>
            <button id="close-modal-btn" class="modal-close-btn">Come√ßar o Desafio!</button>
        </div>
    </div>

    <div id="results-modal" class="modal-overlay">
        <div class="modal-content">
            <h2 id="results-title">Parab√©ns! Voc√™ desvendou o mapa!</h2>
            <p id="results-time"></p>
            <div id="results-gallery"></div>
            <button id="close-results-btn" class="modal-close-btn">Jogar Novamente</button>
        </div>
    </div>

    <div class="game-container">
        <h1>Desafio de L√≥gica: As Regi√µes do Brasil</h1>
        <div id="timer" class="timer">00:00</div>
        <table id="game-table">
            <thead id="game-head"></thead>
            <tbody id="game-body"></tbody>
        </table>
        <br>
        <button id="reiniciar-btn">Novo Desafio</button>
    </div>

    <div class="pistas-container">
        <h3 id="pistas-title">Pistas da Rodada:</h3>
        <div id="pistas-list"></div>
    </div>
    
    <footer>
        <p>
            Mec√¢nica do jogo inspirada em <a href="https://rachacuca.com.br/" target="_blank">Racha Cuca</a>. | 
            Fonte das bandeiras: <a href="https://www.bandeira1.com.br/" target="_blank">Bandeira1.com.br</a>.
        </p>
    </footer>

    <script>
        const bancoDeDados = [
            { regiao: "Norte", estado: "Acre", uf: "AC", capital: "Rio Branco", prato: "Baixaria", bioma: "Amaz√¥nia", economia: "Extrativismo (castanha, borracha)", imagem: "https://i.postimg.cc/t1HWcXG0/Baixaria-AC.jpg", bandeira: "https://i.postimg.cc/cgm9FkQV/bandeira-estado-acre-reta.jpg" }, { regiao: "Norte", estado: "Amap√°", uf: "AP", capital: "Macap√°", prato: "Tucunar√© na chapa", bioma: "Amaz√¥nia", economia: "Extrativismo Mineral (mangan√™s)", imagem: "https://i.postimg.cc/7fdgg3BZ/Tucunar-na-Brasa-AP.jpg", bandeira: "https://i.postimg.cc/kRgjzNsD/bandeira-estado-amapa-reta.jpg" }, { regiao: "Norte", estado: "Amazonas", uf: "AM", capital: "Manaus", prato: "Pirarucu de Casaca", bioma: "Amaz√¥nia", economia: "Polo Industrial de Manaus", imagem: "https://i.postimg.cc/HJ4XDfTr/Pirarucu-de-Casaca-AM.jpg", bandeira: "https://i.postimg.cc/PNXFChHh/bandeira-estado-amazonas-reta.jpg" }, { regiao: "Norte", estado: "Par√°", uf: "PA", capital: "Bel√©m", prato: "Tacac√°", bioma: "Amaz√¥nia", economia: "Minera√ß√£o (ferro)", imagem: "https://i.postimg.cc/3kG29k6C/Tacaca-PA.jpg", bandeira: "https://i.postimg.cc/s1HK1hK9/bandeira-estado-para-reta.jpg" }, { regiao: "Norte", estado: "Rond√¥nia", uf: "RO", capital: "Porto Velho", prato: "Caldeirada de Tambaqui", bioma: "Amaz√¥nia", economia: "Pecu√°ria de Corte", imagem: "https://i.postimg.cc/G9MPpwGY/Caldeirada-de-Tambaqui-RO.jpg", bandeira: "https://i.postimg.cc/vx4r50X7/bandeira-estado-rondonia-reta.jpg" }, { regiao: "Norte", estado: "Roraima", uf: "RR", capital: "Boa Vista", prato: "Pa√ßoca de Carne de Sol", bioma: "Amaz√¥nia", economia: "Agricultura (soja)", imagem: "https://i.postimg.cc/dLL2kHjf/Pacoca-de-Carne-de-Sol-RR.jpg", bandeira: "https://i.postimg.cc/WhJm3fdT/bandeira-estado-roraima-reta.jpg" }, { regiao: "Norte", estado: "Tocantins", uf: "TO", capital: "Palmas", prato: "Chambari", bioma: "Cerrado", economia: "Agroneg√≥cio", imagem: "https://i.postimg.cc/RqCQ9V64/Chambari-TO.jpg", bandeira: "https://i.postimg.cc/wtFLPCGc/bandeira-estado-tocantins-reta.jpg" },
            { regiao: "Nordeste", estado: "Alagoas", uf: "AL", capital: "Macei√≥", prato: "Sururu de Capote", bioma: "Mata Atl√¢ntica", economia: "Turismo", imagem: "https://i.postimg.cc/MMq0nz90/Sururu-de-Capote-AL.jpg", bandeira: "https://i.postimg.cc/FdmCgXJy/bandeira-estado-alagoas-reta.jpg" }, { regiao: "Nordeste", estado: "Bahia", uf: "BA", capital: "Salvador", prato: "Acaraj√©", bioma: "Mata Atl√¢ntica", economia: "Petroqu√≠mica", imagem: "https://i.postimg.cc/XBvwgQSp/Acaraje-BA.jpg", bandeira: "https://i.postimg.cc/ThtNmS2b/bandeira-estado-bahia-reta.jpg" }, { regiao: "Nordeste", estado: "Cear√°", uf: "CE", capital: "Fortaleza", prato: "Bai√£o de Dois", bioma: "Caatinga", economia: "Energia E√≥lica", imagem: "https://i.postimg.cc/McybZnmK/Baiao-de-Dois-CE.jpg", bandeira: "https://i.postimg.cc/Tph7c9h4/bandeira-estado-ceara-reta.jpg" }, { regiao: "Nordeste", estado: "Maranh√£o", uf: "MA", capital: "S√£o Lu√≠s", prato: "Arroz de Cux√°", bioma: "Amaz√¥nia", economia: "Produ√ß√£o de Alum√≠nio", imagem: "https://i.postimg.cc/gXsVR17C/Arroz-de-Cuxa-MA.jpg", bandeira: "https://i.postimg.cc/QBg0MYnH/bandeira-estado-maranhao-reta.jpg" }, { regiao: "Nordeste", estado: "Para√≠ba", uf: "PB", capital: "Jo√£o Pessoa", prato: "Rubac√£o", bioma: "Caatinga", economia: "Ind√∫stria de Cal√ßados", imagem: "https://i.postimg.cc/BjPByY8F/Rubacao-PB.jpg", bandeira: "https://i.postimg.cc/MXpdWD0p/bandeira-estado-paraiba-reta.jpg" }, { regiao: "Nordeste", estado: "Pernambuco", uf: "PE", capital: "Recife", prato: "Bolo de Rolo", bioma: "Mata Atl√¢ntica", economia: "Polo M√©dico", imagem: "https://i.postimg.cc/QHyqfGMs/Bolo-de-Rolo-PE.jpg", bandeira: "https://i.postimg.cc/1fLHr1k8/bandeira-estado-pernambuco-reta.jpg" }, { regiao: "Nordeste", estado: "Piau√≠", uf: "PI", capital: "Teresina", prato: "Maria Isabel", bioma: "Caatinga", economia: "Apicultura", imagem: "https://i.postimg.cc/hfjr8Pcp/Maria-Isabel-PI.jpg", bandeira: "https://i.postimg.cc/SnCGZt4D/bandeira-estado-piaui-reta.jpg" }, { regiao: "Nordeste", estado: "Rio Grande do Norte", uf: "RN", capital: "Natal", prato: "Ginga com Tapioca", bioma: "Caatinga", economia: "Produ√ß√£o de Sal Marinho", imagem: "https://i.postimg.cc/2LjxKCvj/Ginga-com-Tapioca-RN.jpg", bandeira: "https://i.postimg.cc/8FGmxBPD/bandeira-estado-rio-grande-do-norte-reta.jpg" }, { regiao: "Nordeste", estado: "Sergipe", uf: "SE", capital: "Aracaju", prato: "Caranguejada", bioma: "Mata Atl√¢ntica", economia: "Extra√ß√£o de Petr√≥leo", imagem: "https://i.postimg.cc/QVSmWWGF/Caranguejada-SE.jpg", bandeira: "https://i.postimg.cc/Mcz196dp/bandeira-estado-sergipe-reta.jpg" },
            { regiao: "Centro-Oeste", estado: "Goi√°s", uf: "GO", capital: "Goi√¢nia", prato: "Arroz com Pequi", bioma: "Cerrado", economia: "Agroneg√≥cio", imagem: "https://i.postimg.cc/NKZpjqhb/Arroz-com-Pequi-GO.jpg", bandeira: "https://i.postimg.cc/CZpcSp73/bandeira-estado-goias-reta.jpg" }, { regiao: "Centro-Oeste", estado: "Mato Grosso", uf: "MT", capital: "Cuiab√°", prato: "Mojica de Pintado", bioma: "Cerrado", economia: "Produ√ß√£o de Soja", imagem: "https://i.postimg.cc/phJZCmm1/Mojica-de-Pintado-MT.jpg", bandeira: "https://i.postimg.cc/Pp2yWpHH/bandeira-estado-mato-grosso-reta.jpg" }, { regiao: "Centro-Oeste", estado: "Mato Grosso do Sul", uf: "MS", capital: "Campo Grande", prato: "Sopa Paraguaia", bioma: "Pantanal", economia: "Pecu√°ria", imagem: "https://i.postimg.cc/V5z46WTy/Sopa-Paraguaia-MS.jpg", bandeira: "https://i.postimg.cc/dkqnZRzn/bandeira-estado-mato-grosso-do-sul-reta.jpg" }, { regiao: "Centro-Oeste", estado: "Distrito Federal", uf: "DF", capital: "Bras√≠lia", prato: "Galinhada", bioma: "Cerrado", economia: "Servi√ßo P√∫blico", imagem: "https://i.postimg.cc/431WDMF6/Galinhada-DF.jpg", bandeira: "https://i.postimg.cc/d7GSyVDQ/bandeira-distrito-federal-reta.jpg" },
            { regiao: "Sudeste", estado: "Esp√≠rito Santo", uf: "ES", capital: "Vit√≥ria", prato: "Moqueca Capixaba", bioma: "Mata Atl√¢ntica", economia: "Com√©rcio Exterior (Portos)", imagem: "https://i.postimg.cc/62XcCrpv/Moqueca-Capixaba-ES.jpg", bandeira: "https://i.postimg.cc/sv8nHhhD/bandeira-estado-espirito-santo-reta.jpg" }, { regiao: "Sudeste", estado: "Minas Gerais", uf: "MG", capital: "Belo Horizonte", prato: "P√£o de Queijo", bioma: "Cerrado", economia: "Minera√ß√£o", imagem: "https://i.postimg.cc/yJ9nJQsK/Pao-de-queijo-MG.jpg", bandeira: "https://i.postimg.cc/D40gBvfX/bandeira-estado-minas-gerais-reta.jpg" }, { regiao: "Sudeste", estado: "Rio de Janeiro", uf: "RJ", capital: "Rio de Janeiro", prato: "Feijoada", bioma: "Mata Atl√¢ntica", economia: "Petr√≥leo e G√°s", imagem: "https://i.postimg.cc/CRRc0M2z/Feijoada-RJ.jpg", bandeira: "https://i.postimg.cc/7Gs1CF1Y/bandeira-estado-rio-de-janeiro-reta.jpg" }, { regiao: "Sudeste", estado: "S√£o Paulo", uf: "SP", capital: "S√£o Paulo", prato: "Virado √† Paulista", bioma: "Mata Atl√¢ntica", economia: "Ind√∫stria", imagem: "https://i.postimg.cc/tYSB8n2K/Virado-a-Paulista-SP.jpg", bandeira: "https://i.postimg.cc/5yb94QDK/bandeira-estado-sao-paulo-reta.jpg" }, 
            { regiao: "Sul", estado: "Paran√°", uf: "PR", capital: "Curitiba", prato: "Barreado", bioma: "Mata Atl√¢ntica", economia: "Energia Hidrel√©trica", imagem: "https://i.postimg.cc/vcHPPtL7/Barreado-PR.jpg", bandeira: "https://i.postimg.cc/dL76CVxM/bandeira-estado-parana-reta.jpg" }, { regiao: "Sul", estado: "Rio Grande do Sul", uf: "RS", capital: "Porto Alegre", prato: "Churrasco", bioma: "Pampa", economia: "Agroind√∫stria", imagem: "https://i.postimg.cc/DmcjdMsy/Churrasco-RS.jpg", bandeira: "https://i.postimg.cc/mz2NgLH5/bandeira-estado-rio-grande-do-sul-reta.jpg" }, { regiao: "Sul", estado: "Santa Catarina", uf: "SC", capital: "Florian√≥polis", prato: "Sequ√™ncia de Camar√£o", bioma: "Mata Atl√¢ntica", economia: "Ind√∫stria T√™xtil", imagem: "https://i.postimg.cc/sG3nCYFr/Sequencia-de-Camarao-SC.jpg", bandeira: "https://i.postimg.cc/21Q4dbdt/bandeira-estado-santa-catarina-reta.jpg" }
        ];

        let gabaritoDaRodada = [], todasAsOpcoes = {}, mapaDePistas = new Map();
        const regioes = ["Norte", "Nordeste", "Centro-Oeste", "Sudeste", "Sul"];
        const categorias = ["estado", "capital", "prato", "bioma", "economia"];
        let timerInterval, startTime, isFirstSelection = true;

        function iniciarJogo() {
            resetTimer();
            gerarGabarito();
            gerarPistas();
            montarInterface();
            atualizarStatusDoJogo();
        }

        function setupIntroModal() {
            const modal = document.getElementById('intro-modal'), closeModalBtn = document.getElementById('close-modal-btn');
            if (!sessionStorage.getItem('introShown')) modal.style.display = 'flex';
            closeModalBtn.addEventListener('click', () => { modal.style.display = 'none'; sessionStorage.setItem('introShown', 'true'); });
        }

        function startTimer() { if (isFirstSelection) { startTime = Date.now(); timerInterval = setInterval(updateTimer, 1000); isFirstSelection = false; } }
        function stopTimer() { clearInterval(timerInterval); }
        function resetTimer() { stopTimer(); document.getElementById('timer').textContent = "00:00"; isFirstSelection = true; }
        function updateTimer() {
            const elapsed = Date.now() - startTime, minutes = Math.floor(elapsed / 60000).toString().padStart(2, '0'), seconds = Math.floor((elapsed % 60000) / 1000).toString().padStart(2, '0');
            document.getElementById('timer').textContent = `${minutes}:${seconds}`;
        }

        function gerarGabarito() {
            gabaritoDaRodada = [];
            regioes.forEach(regiaoNome => {
                const pacotesPossiveis = bancoDeDados.filter(p => p.regiao === regiaoNome);
                gabaritoDaRodada.push(pacotesPossiveis[Math.floor(Math.random() * pacotesPossiveis.length)]);
            });
            console.log("Gabarito Secreto Desta Rodada:", gabaritoDaRodada);
        }
        
        function gerarPistas() {
            mapaDePistas.clear();
            const s = gabaritoDaRodada;
            const pistasGeradas = [];

            // Gera uma cadeia de 5 pistas interligadas para cada uma das 5 regi√µes
            for (let i = 0; i < 5; i++) {
                const grupo = [
                    { texto: `Na coluna da regi√£o ${regioes[i]}, o estado √© ${s[i].estado}.`,
                      checar: (grid) => grid[i].estado === s[i].estado },
                    { texto: `A capital do estado de ${s[i].estado} √© ${s[i].capital}.`,
                      checar: (grid) => grid[i].estado === s[i].estado && grid[i].capital === s[i].capital },
                    { texto: `O prato t√≠pico servido em ${s[i].capital} √© o ${s[i].prato}.`,
                      checar: (grid) => grid[i].capital === s[i].capital && grid[i].prato === s[i].prato },
                    { texto: `O bioma correspondente ao estado de ${s[i].estado} √© o ${s[i].bioma}.`,
                      checar: (grid) => grid[i].estado === s[i].estado && grid[i].bioma === s[i].bioma },
                    { texto: `A principal atividade econ√¥mica na regi√£o do prato ${s[i].prato} √© a ${s[i].economia}.`,
                      checar: (grid) => grid[i].prato === s[i].prato && grid[i].economia === s[i].economia }
                ];
                pistasGeradas.push(...grupo);
            }
            
            // Embaralha a lista completa de 25 pistas
            pistasGeradas.sort(() => Math.random() - 0.5);

            pistasGeradas.forEach(pista => {
                mapaDePistas.set(pista.texto, pista.checar);
            });

            const containerDePistas = document.getElementById('pistas-list'), lista = document.createElement('ul');
            pistasGeradas.forEach(pista => { const item = document.createElement('li'); item.textContent = pista.texto; item.dataset.pista = pista.texto; lista.appendChild(item); });
            containerDePistas.innerHTML = ''; containerDePistas.appendChild(lista);
        }

        function montarInterface() {
             todasAsOpcoes = {
                estado: [...new Set(bancoDeDados.map(p => p.estado))].sort(), capital: [...new Set(bancoDeDados.map(p => p.capital))].sort(),
                prato: [...new Set(bancoDeDados.map(p => p.prato))].sort(), bioma: [...new Set(bancoDeDados.map(p => p.bioma))].sort(), 
                economia: [...new Set(bancoDeDados.map(p => p.economia))].sort()
            };
            const tableHead = document.getElementById('game-head'), tableBody = document.getElementById('game-body');
            tableHead.innerHTML = `<tr><th>Categoria</th><th>${regioes.join('</th><th>')}</th></tr>`;
            tableBody.innerHTML = '';
            categorias.forEach(cat => {
                const row = document.createElement('tr');
                row.innerHTML = `<th>${cat.charAt(0).toUpperCase() + cat.slice(1)}</th>`;
                regioes.forEach((reg, index) => {
                    const cell = document.createElement('td'), select = document.createElement('select');
                    select.dataset.categoria = cat; select.dataset.coluna = index;
                    select.innerHTML = `<option value="">Selecione</option>`;
                    todasAsOpcoes[cat].forEach(opcao => select.innerHTML += `<option value="${opcao}">${opcao}</option>`);
                    select.addEventListener('change', () => { startTimer(); atualizarStatusDoJogo(); });
                    cell.appendChild(select); row.appendChild(cell);
                });
                tableBody.appendChild(row);
            });
        }

        function mostrarResultados() {
            const modal = document.getElementById('results-modal'), gallery = document.getElementById('results-gallery'), timeElement = document.getElementById('results-time');
            gallery.innerHTML = ''; timeElement.textContent = `Seu tempo foi de ${document.getElementById('timer').textContent}.`;
            gabaritoDaRodada.forEach(item => { 
                gallery.innerHTML += `<figure class="gallery-item"><h4 class="prato-titulo">${item.prato}</h4><img src="${item.imagem}" alt="${item.prato}"><figcaption><img src="${item.bandeira}" alt="Bandeira de ${item.estado}" class="bandeira-estado"><div class="caption-text"><strong>${item.estado} (${item.uf})</strong><br><small>Capital: ${item.capital}</small></div></figcaption></figure>`;
            });
            modal.style.display = 'flex';
        }

        function atualizarStatusDoJogo() {
            const gridAtual = regioes.map((reg, index) => {
                const coluna = {};
                categorias.forEach(cat => { coluna[cat] = document.querySelector(`select[data-coluna='${index}'][data-categoria='${cat}']`).value; });
                return coluna;
            });
            mapaDePistas.forEach((funcaoDeVerificacao, textoDaPista) => {
                const elPista = document.querySelector(`li[data-pista="${textoDaPista}"]`);
                if (elPista && funcaoDeVerificacao(gridAtual)) { elPista.classList.add('pista-satisfeita'); } 
                else if (elPista) { elPista.classList.remove('pista-satisfeita'); }
            });
            let acertos = 0;
            document.querySelectorAll('select').forEach(select => {
                const coluna = parseInt(select.dataset.coluna), categoria = select.dataset.categoria;
                const respostaCorreta = gabaritoDaRodada[coluna][categoria];
                const respostaUsuario = select.value;
                select.classList.remove('select-correct', 'select-incorrect');
                if (respostaUsuario === respostaCorreta) { select.classList.add('select-correct'); acertos++; } 
                else if (respostaUsuario !== "") { select.classList.add('select-incorrect'); }
            });
            if (acertos === 25) { stopTimer(); setTimeout(mostrarResultados, 200); }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            iniciarJogo();
            setupIntroModal();
            document.getElementById('reiniciar-btn').addEventListener('click', iniciarJogo);
            document.getElementById('close-results-btn').addEventListener('click', () => {
                document.getElementById('results-modal').style.display = 'none';
                iniciarJogo();
            });
        });
    </script>
</body>
</html>
