<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desafio de L√≥gica: As Regi√µes do Brasil</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; display: flex; flex-wrap: wrap; gap: 30px; padding: 20px; background-color: #f4f7f9; }
        .game-container { flex: 3; min-width: 600px; }
        .pistas-container { flex: 2; min-width: 300px; background-color: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        table { width: 100%; border-collapse: collapse; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        th, td { border: 1px solid #dfe6e9; padding: 12px; text-align: left; vertical-align: middle; }
        th { background-color: #f2f2f2; font-weight: bold; }
        select { width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #b2bec3; background-color: #fff; transition: background-color 0.3s, border-color 0.3s; }
        button { background-color: #d63031; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 16px; margin-right: 10px; margin-top: 15px; }
        button:hover { background-color: #b01e1f; }
        h1, h3 { color: #2d3436; }
        h3 { border-bottom: 2px solid #0984e3; padding-bottom: 5px; margin-top: 0;}
        .pistas-container ul { list-style: none; padding-left: 0; margin: 0; }
        .pistas-container li { margin-bottom: 12px; line-height: 1.5; padding: 8px; border-radius: 4px; transition: all 0.4s ease; border-left: 5px solid #dfe6e9;}
        .pista-satisfeita { color: #555; border-left-color: #27ae60; background-color: #f0fff4; text-decoration: line-through; }
        .pista-satisfeita::before { content: '‚úì '; color: #27ae60; font-weight: bold;}
        .select-correct { background-color: #c8e6c9 !important; border-color: #2e7d32 !important; }
        .select-incorrect { background-color: #ffcdd2 !important; border-color: #c62828 !important; }
        .timer { font-size: 2em; font-weight: bold; color: #e74c3c; text-align: center; margin: 10px 0 20px 0; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); display: none; justify-content: center; align-items: center; z-index: 1000; padding: 20px; box-sizing: border-box; }
        .modal-content { background: white; padding: 20px 40px; border-radius: 10px; max-width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 5px 15px rgba(0,0,0,0.3); text-align: center; }
        .modal-content h2 { color: #2c3e50; }
        .modal-content h4 { color: #3498db; margin-top: 20px; }
        .modal-close-btn { display: block; margin: 20px auto 0; padding: 10px 30px; font-size: 16px; font-weight: bold; cursor: pointer; background-color: #27ae60; color: white; border: none; border-radius: 5px; }
        .modal-close-btn:hover { background-color: #229954; }
        #results-gallery { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; margin-top: 20px; }
        .gallery-item { width: 18%; min-width: 150px; background-color: #f9f9f9; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .gallery-item img { width: 100%; height: 120px; object-fit: cover; border-bottom: 1px solid #eee;}
        .gallery-item figcaption { padding: 10px; font-weight: bold; color: #333; }
    </style>
</head>
<body>
    <div id="intro-modal" class="modal-overlay">
        <div class="modal-content">
            <h2>Bem-vindo ao Desafio das Regi√µes Brasileiras!</h2>
            <p>Sua miss√£o √© usar as pistas para preencher o mapa do Brasil. Este guia r√°pido lhe dar√° o conhecimento b√°sico para come√ßar. Boa sorte!</p>
            <h4>üå≥ Regi√£o Norte</h4><p>A maior regi√£o do pa√≠s, dominada pela Floresta Amaz√¥nica. Sua economia √© forte no extrativismo e sua culin√°ria usa ingredientes √∫nicos como no Tacac√°.</p>
            <h4>‚òÄÔ∏è Regi√£o Nordeste</h4><p>O ber√ßo cultural do Brasil, com um vasto litoral que impulsiona o Turismo. √â famosa por pratos de sabor forte como o Acaraj√© e pela Caatinga no sert√£o.</p>
            <h4>üå± Regi√£o Centro-Oeste</h4><p>O cora√ß√£o do Agroneg√≥cio brasileiro, com o bioma Cerrado e a plan√≠cie do Pantanal. A culin√°ria reflete a terra, como no Arroz com Pequi.</p>
            <h4>üè≠ Regi√£o Sudeste</h4><p>A pot√™ncia econ√¥mica e industrial, e a mais populosa. Abriga metr√≥poles como S√£o Paulo e tesouros da Mata Atl√¢ntica.</p>
            <h4>‚ùÑÔ∏è Regi√£o Sul</h4><p>De clima mais frio e forte influ√™ncia europeia, tem a Agroind√∫stria como destaque e o Pampa como bioma caracter√≠stico.</p>
            <button id="close-modal-btn" class="modal-close-btn">Come√ßar o Desafio!</button>
        </div>
    </div>

    <div id="results-modal" class="modal-overlay">
        <div class="modal-content">
            <h2 id="results-title">Parab√©ns! Voc√™ desvendou o mapa!</h2>
            <p id="results-time"></p>
            <div id="results-gallery"></div>
            <button id="close-results-btn" class="modal-close-btn">Jogar Novamente</button>
        </div>
    </div>

    <div class="game-container">
        <h1>Desafio de L√≥gica: As Regi√µes do Brasil</h1>
        <div id="timer" class="timer">00:00</div>
        <table id="game-table">
            <thead id="game-head"></thead>
            <tbody id="game-body"></tbody>
        </table>
        <br>
        <button id="reiniciar-btn">Novo Desafio</button>
    </div>

    <div class="pistas-container">
        <h3 id="pistas-title">Pistas da Rodada:</h3>
        <div id="pistas-list"></div>
    </div>

    <script>
        const bancoDeDados = [
            { regiao: "Norte", estado: "Acre", prato: "Baixaria", bioma: "Amaz√¥nia", economia: "Extrativismo (castanha, borracha)", imagem: "https://i.imgur.com/2b3j2C2.jpeg" }, { regiao: "Norte", estado: "Amap√°", prato: "Tucunar√© na chapa", bioma: "Amaz√¥nia", economia: "Extrativismo Mineral (mangan√™s)", imagem: "https://i.imgur.com/u7vlh3i.jpeg" }, { regiao: "Norte", estado: "Amazonas", prato: "Pirarucu de Casaca", bioma: "Amaz√¥nia", economia: "Polo Industrial de Manaus", imagem: "https://i.imgur.com/sV5aC4O.jpeg" }, { regiao: "Norte", estado: "Par√°", prato: "Tacac√°", bioma: "Amaz√¥nia", economia: "Minera√ß√£o (ferro)", imagem: "https://i.imgur.com/hOYj2p1.jpeg" }, { regiao: "Norte", estado: "Rond√¥nia", prato: "Caldeirada de Tambaqui", bioma: "Amaz√¥nia", economia: "Pecu√°ria de Corte", imagem: "https://i.imgur.com/qU3aY0h.jpeg" }, { regiao: "Norte", estado: "Roraima", prato: "Pa√ßoca de Carne de Sol", bioma: "Amaz√¥nia", economia: "Agricultura (soja)", imagem: "https://i.imgur.com/Y1m2bHA.jpeg" }, { regiao: "Norte", estado: "Tocantins", prato: "Chambari", bioma: "Cerrado", economia: "Agroneg√≥cio", imagem: "https://i.imgur.com/V2d0d0c.jpeg" },
            { regiao: "Nordeste", estado: "Alagoas", prato: "Sururu de Capote", bioma: "Mata Atl√¢ntica", economia: "Turismo", imagem: "https://i.imgur.com/Q283v4a.jpeg" }, { regiao: "Nordeste", estado: "Bahia", prato: "Acaraj√©", bioma: "Mata Atl√¢ntica", economia: "Petroqu√≠mica", imagem: "https://i.imgur.com/ZzTa1gs.jpeg" }, { regiao: "Nordeste", estado: "Cear√°", prato: "Bai√£o de Dois", bioma: "Caatinga", economia: "Energia E√≥lica", imagem: "https://i.imgur.com/C53p1Ze.jpeg" }, { regiao: "Nordeste", estado: "Maranh√£o", prato: "Arroz de Cux√°", bioma: "Amaz√¥nia", economia: "Produ√ß√£o de Alum√≠nio", imagem: "https://i.imgur.com/NfOPG6A.jpeg" }, { regiao: "Nordeste", estado: "Para√≠ba", prato: "Rubac√£o", bioma: "Caatinga", economia: "Ind√∫stria de Cal√ßados", imagem: "https://i.imgur.com/n14aQ8n.jpeg" }, { regiao: "Nordeste", estado: "Pernambuco", prato: "Bolo de Rolo", bioma: "Mata Atl√¢ntica", economia: "Polo M√©dico", imagem: "https://i.imgur.com/v0Qik08.jpeg" }, { regiao: "Nordeste", estado: "Piau√≠", prato: "Maria Isabel", bioma: "Caatinga", economia: "Apicultura", imagem: "https://i.imgur.com/39A0j6i.jpeg" }, { regiao: "Nordeste", estado: "Rio Grande do Norte", prato: "Ginga com Tapioca", bioma: "Caatinga", economia: "Produ√ß√£o de Sal Marinho", imagem: "https://i.imgur.com/UfG5a7E.jpeg" }, { regiao: "Nordeste", estado: "Sergipe", prato: "Caranguejada", bioma: "Mata Atl√¢ntica", economia: "Extra√ß√£o de Petr√≥leo", imagem: "https://i.imgur.com/lM3YQ4O.jpeg" },
            { regiao: "Centro-Oeste", estado: "Goi√°s", prato: "Arroz com Pequi", bioma: "Cerrado", economia: "Agroneg√≥cio", imagem: "https://i.imgur.com/Cq4b4s4.jpeg" }, { regiao: "Centro-Oeste", estado: "Mato Grosso", prato: "Mojica de Pintado", bioma: "Cerrado", economia: "Produ√ß√£o de Soja", imagem: "https://i.imgur.com/kS5x0g8.jpeg" }, { regiao: "Centro-Oeste", estado: "Mato Grosso do Sul", prato: "Sopa Paraguaia", bioma: "Pantanal", economia: "Pecu√°ria", imagem: "https://i.imgur.com/83pAF68.jpeg" }, { regiao: "Centro-Oeste", estado: "Distrito Federal", prato: "Galinhada", bioma: "Cerrado", economia: "Servi√ßo P√∫blico", imagem: "https://i.imgur.com/k7j4I5S.jpeg" },
            { regiao: "Sudeste", estado: "Esp√≠rito Santo", prato: "Moqueca Capixaba", bioma: "Mata Atl√¢ntica", economia: "Com√©rcio Exterior (Portos)", imagem: "https://i.imgur.com/4E19g5p.jpeg" }, { regiao: "Sudeste", estado: "Minas Gerais", prato: "P√£o de Queijo", bioma: "Cerrado", economia: "Minera√ß√£o", imagem: "https://i.imgur.com/2fVEvAg.jpeg" }, { regiao: "Sudeste", estado: "Rio de Janeiro", prato: "Feijoada", bioma: "Mata Atl√¢ntica", economia: "Petr√≥leo e G√°s", imagem: "https://i.imgur.com/Z1hBf5H.jpeg" }, { regiao: "Sudeste", estado: "S√£o Paulo", prato: "Virado √† Paulista", bioma: "Mata Atl√¢ntica", economia: "Ind√∫stria", imagem: "https://i.imgur.com/2sZZRER.jpeg" },
            { regiao: "Sul", estado: "Paran√°", prato: "Barreado", bioma: "Mata Atl√¢ntica", economia: "Energia Hidrel√©trica", imagem: "https://i.imgur.com/L7gyjdb.jpeg" }, { regiao: "Sul", estado: "Rio Grande do Sul", prato: "Churrasco", bioma: "Pampa", economia: "Agroind√∫stria", imagem: "https://i.imgur.com/FwWk5VF.jpeg" }, { regiao: "Sul", estado: "Santa Catarina", prato: "Sequ√™ncia de Camar√£o", bioma: "Mata Atl√¢ntica", economia: "Ind√∫stria T√™xtil", imagem: "https://i.imgur.com/qHwQzP7.jpeg" }
        ];

        let gabaritoDaRodada = [], todasAsOpcoes = {}, mapaDePistas = new Map();
        const regioes = ["Norte", "Nordeste", "Centro-Oeste", "Sudeste", "Sul"];
        const categorias = ["estado", "prato", "bioma", "economia"];
        let timerInterval, startTime, isFirstSelection = true;

        function iniciarJogo() {
            resetTimer();
            gerarGabarito();
            gerarPistas();
            montarInterface();
            atualizarStatusDoJogo();
        }

        function setupIntroModal() {
            const modal = document.getElementById('intro-modal'), closeModalBtn = document.getElementById('close-modal-btn');
            if (!sessionStorage.getItem('introShown')) modal.style.display = 'flex';
            closeModalBtn.addEventListener('click', () => { modal.style.display = 'none'; sessionStorage.setItem('introShown', 'true'); });
        }

        function startTimer() { if (isFirstSelection) { startTime = Date.now(); timerInterval = setInterval(updateTimer, 1000); isFirstSelection = false; } }
        function stopTimer() { clearInterval(timerInterval); }
        function resetTimer() { stopTimer(); document.getElementById('timer').textContent = "00:00"; isFirstSelection = true; }
        function updateTimer() {
            const elapsed = Date.now() - startTime, minutes = Math.floor(elapsed / 60000).toString().padStart(2, '0'), seconds = Math.floor((elapsed % 60000) / 1000).toString().padStart(2, '0');
            document.getElementById('timer').textContent = `${minutes}:${seconds}`;
        }

        function gerarGabarito() {
            gabaritoDaRodada = [];
            regioes.forEach(regiaoNome => {
                const pacotesPossiveis = bancoDeDados.filter(p => p.regiao === regiaoNome);
                gabaritoDaRodada.push(pacotesPossiveis[Math.floor(Math.random() * pacotesPossiveis.length)]);
            });
            console.log("Gabarito Secreto Desta Rodada:", gabaritoDaRodada);
        }

        function gerarPistas() {
            mapaDePistas.clear();
            const s = gabaritoDaRodada, idx = { Norte: 0, Nordeste: 1, CentroOeste: 2, Sudeste: 3, Sul: 4 };
            mapaDePistas.set(`Na coluna da regi√£o Sul, o bioma √© o ${s[idx.Sul].bioma}.`, (grid) => grid[idx.Sul].bioma === s[idx.Sul].bioma);
            mapaDePistas.set(`O estado que tem como bioma o ${s[idx.Sul].bioma} √© o ${s[idx.Sul].estado}.`, (grid) => grid[idx.Sul].estado === s[idx.Sul].estado);
            mapaDePistas.set(`A economia principal no estado de ${s[idx.Sul].estado} √© a ${s[idx.Sul].economia}.`, (grid) => grid[idx.Sul].economia === s[idx.Sul].economia);
            mapaDePistas.set(`A coluna √† esquerda da regi√£o Sul √© a Sudeste. Nela, o estado √© ${s[idx.Sudeste].estado}.`, (grid) => grid[idx.Sudeste].estado === s[idx.Sudeste].estado);
            mapaDePistas.set(`O prato servido no estado de ${s[idx.Sudeste].estado} √© o ${s[idx.Sudeste].prato}.`, (grid) => grid[idx.Sudeste].prato === s[idx.Sudeste].prato);
            mapaDePistas.set(`A economia na regi√£o do prato ${s[idx.Sudeste].prato} √© a ${s[idx.Sudeste].economia}.`, (grid) => grid[idx.Sudeste].economia === s[idx.Sudeste].economia);
            mapaDePistas.set(`Na coluna da regi√£o Norte, o estado √© ${s[idx.Norte].estado}.`, (grid) => grid[idx.Norte].estado === s[idx.Norte].estado);
            mapaDePistas.set(`O bioma do estado do ${s[idx.Norte].estado} √© a ${s[idx.Norte].bioma}.`, (grid) => grid[idx.Norte].bioma === s[idx.Norte].bioma);
            mapaDePistas.set(`A economia na regi√£o do bioma ${s[idx.Norte].bioma} √© o ${s[idx.Norte].economia}.`, (grid) => grid[idx.Norte].economia === s[idx.Norte].economia);
            mapaDePistas.set(`A coluna √† direita da regi√£o Norte √© a Nordeste. Nela, a economia √© o ${s[idx.Nordeste].economia}.`, (grid) => grid[idx.Nordeste].economia === s[idx.Nordeste].economia);
            mapaDePistas.set(`O estado correspondente √† economia de ${s[idx.Nordeste].economia} √© a ${s[idx.Nordeste].estado}.`, (grid) => grid[idx.Nordeste].estado === s[idx.Nordeste].estado);
            mapaDePistas.set(`O prato t√≠pico do estado da ${s[idx.Nordeste].estado} √© o ${s[idx.Nordeste].prato}.`, (grid) => grid[idx.Nordeste].prato === s[idx.Nordeste].prato);
            mapaDePistas.set(`O bioma na regi√£o do ${s[idx.Nordeste].prato} √© a ${s[idx.Nordeste].bioma}.`, (grid) => grid[idx.Nordeste].bioma === s[idx.Nordeste].bioma);
            mapaDePistas.set(`Na coluna do Centro-Oeste, o bioma √© o ${s[idx.CentroOeste].bioma}.`, (grid) => grid[idx.CentroOeste].bioma === s[idx.CentroOeste].bioma);
            mapaDePistas.set(`O estado que tem como bioma o ${s[idx.CentroOeste].bioma} √© ${s[idx.CentroOeste].estado}.`, (grid) => grid[idx.CentroOeste].estado === s[idx.CentroOeste].estado);
            mapaDePistas.set(`O prato que falta na coluna Sul √© o ${s[idx.Sul].prato}.`, (grid) => grid[idx.Sul].prato === s[idx.Sul].prato);
            mapaDePistas.set(`O bioma que falta na coluna Sudeste √© a ${s[idx.Sudeste].bioma}.`, (grid) => grid[idx.Sudeste].bioma === s[idx.Sudeste].bioma);
            mapaDePistas.set(`O prato que falta na coluna do Centro-Oeste √© o ${s[idx.CentroOeste].prato}.`, (grid) => grid[idx.CentroOeste].prato === s[idx.CentroOeste].prato);
            mapaDePistas.set(`A economia que falta na coluna do Centro-Oeste √© o ${s[idx.CentroOeste].economia}.`, (grid) => grid[idx.CentroOeste].economia === s[idx.CentroOeste].economia);
            mapaDePistas.set(`O prato que falta na coluna Norte √© o ${s[idx.Norte].prato}.`, (grid) => grid[idx.Norte].prato === s[idx.Norte].prato);

            const containerDePistas = document.getElementById('pistas-list'), lista = document.createElement('ul');
            const pistasEmbaralhadas = Array.from(mapaDePistas.keys()).sort(() => Math.random() - 0.5);
            pistasEmbaralhadas.forEach(pista => { const item = document.createElement('li'); item.textContent = pista; item.dataset.pista = pista; lista.appendChild(item); });
            containerDePistas.innerHTML = ''; containerDePistas.appendChild(lista);
        }

        function montarInterface() {
             todasAsOpcoes = {
                estado: [...new Set(bancoDeDados.map(p => p.estado))].sort(), prato: [...new Set(bancoDeDados.map(p => p.prato))].sort(),
                bioma: [...new Set(bancoDeDados.map(p => p.bioma))].sort(), economia: [...new Set(bancoDeDados.map(p => p.economia))].sort()
            };
            const tableHead = document.getElementById('game-head'), tableBody = document.getElementById('game-body');
            tableHead.innerHTML = `<tr><th>Categoria</th><th>${regioes.join('</th><th>')}</th></tr>`;
            tableBody.innerHTML = '';
            categorias.forEach(cat => {
                const row = document.createElement('tr');
                row.innerHTML = `<th>${cat.charAt(0).toUpperCase() + cat.slice(1)}</th>`;
                regioes.forEach((reg, index) => {
                    const cell = document.createElement('td'), select = document.createElement('select');
                    select.dataset.categoria = cat; select.dataset.coluna = index;
                    select.innerHTML = `<option value="">Selecione</option>`;
                    todasAsOpcoes[cat].forEach(opcao => select.innerHTML += `<option value="${opcao}">${opcao}</option>`);
                    select.addEventListener('change', () => { startTimer(); atualizarStatusDoJogo(); });
                    cell.appendChild(select); row.appendChild(cell);
                });
                tableBody.appendChild(row);
            });
        }

        function mostrarResultados() {
            const modal = document.getElementById('results-modal'), gallery = document.getElementById('results-gallery'), timeElement = document.getElementById('results-time');
            gallery.innerHTML = ''; timeElement.textContent = `Seu tempo foi de ${document.getElementById('timer').textContent}.`;
            gabaritoDaRodada.forEach(item => { gallery.innerHTML += `<figure class="gallery-item"><img src="${item.imagem}" alt="${item.prato}"><figcaption>${item.prato} (${item.estado})</figcaption></figure>`; });
            modal.style.display = 'flex';
        }

        function atualizarStatusDoJogo() {
            const gridAtual = regioes.map((reg, index) => {
                const coluna = {};
                categorias.forEach(cat => { coluna[cat] = document.querySelector(`select[data-coluna='${index}'][data-categoria='${cat}']`).value; });
                return coluna;
            });
            
            // --- CORRE√á√ÉO: L√ìGICA DE VERIFICA√á√ÉO INDIVIDUAL DAS PISTAS RESTAURADA ---
            mapaDePistas.forEach((funcaoDeVerificacao, textoDaPista) => {
                const elPista = document.querySelector(`li[data-pista="${textoDaPista}"]`);
                if (funcaoDeVerificacao(gridAtual)) {
                    elPista.classList.add('pista-satisfeita');
                } else {
                    elPista.classList.remove('pista-satisfeita');
                }
            });

            let acertos = 0;
            document.querySelectorAll('select').forEach(select => {
                const coluna = parseInt(select.dataset.coluna), categoria = select.dataset.categoria;
                const respostaCorreta = gabaritoDaRodada[coluna][categoria];
                const respostaUsuario = select.value;
                select.classList.remove('select-correct', 'select-incorrect');
                if (respostaUsuario === respostaCorreta) { select.classList.add('select-correct'); acertos++; } 
                else if (respostaUsuario !== "") { select.classList.add('select-incorrect'); }
            });

            if (acertos === 20) {
                stopTimer();
                setTimeout(mostrarResultados, 200);
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            iniciarJogo();
            setupIntroModal();
            document.getElementById('reiniciar-btn').addEventListener('click', iniciarJogo);
            document.getElementById('close-results-btn').addEventListener('click', () => {
                document.getElementById('results-modal').style.display = 'none';
                iniciarJogo();
            });
        });
    </script>
</body>
</html>
