<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sequ√™ncias Num√©ricas - N√∫meros √önicos por Tela</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', 'Arial Rounded MT Bold', sans-serif;
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border: 5px solid #ff6b6b;
        }

        .header {
            text-align: center;
            margin-bottom: 15px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            padding: 20px;
            border-radius: 15px;
            color: white;
        }

        .header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .tabs-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab {
            padding: 15px 25px;
            border-radius: 15px 15px 0 0;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1em;
            border: 3px solid;
            border-bottom: none;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 200px;
            justify-content: center;
        }

        .tab.active {
            transform: translateY(0);
            box-shadow: 0 -3px 10px rgba(0,0,0,0.1);
        }

        .tab-1 {
            background: linear-gradient(135deg, #ffd166 0%, #ffef9f 100%);
            border-color: #ff9a00;
            color: #996600;
        }

        .tab-2 {
            background: linear-gradient(135deg, #a5d6a7 0%, #c8e6c9 100%);
            border-color: #4caf50;
            color: #2e7d32;
        }

        .tab-3 {
            background: linear-gradient(135deg, #4facfe 0%, #8fd3f4 100%);
            border-color: #2196f3;
            color: #1565c0;
        }

        .tab-4 {
            background: linear-gradient(135deg, #d4a5e6 0%, #e9c7f5 100%);
            border-color: #9c27b0;
            color: #6a1b9a;
        }

        .tab-content {
            background: #f8f9fa;
            border-radius: 0 15px 15px 15px;
            padding: 25px;
            border: 3px solid;
            min-height: 550px;
            display: none;
        }

        .tab-content-1 { border-color: #ff9a00; }
        .tab-content-2 { border-color: #4caf50; }
        .tab-content-3 { border-color: #2196f3; }
        .tab-content-4 { border-color: #9c27b0; }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .game-stats {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            background: #e3f2fd;
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 3px solid #4facfe;
        }

        .stat {
            text-align: center;
            background: white;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #ff6b6b;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
            font-weight: bold;
        }

        .screen-info {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 15px;
        }

        .progress-container {
            margin: 15px 0;
            padding: 10px;
            background: rgba(255,255,255,0.8);
            border-radius: 10px;
        }

        .progress-bar {
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4caf50, #8bc34a);
            width: 0%;
            transition: width 0.5s;
            border-radius: 10px;
        }

        .exercises-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        @media (max-width: 900px) {
            .exercises-container {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 600px) {
            .exercises-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .exercise {
            background: white;
            border: 3px solid;
            border-radius: 15px;
            padding: 15px;
            min-height: 140px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .sequence-slots {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 8px;
            flex-wrap: wrap;
        }

        .slot {
            width: 45px;
            height: 45px;
            border: 3px solid;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3em;
            font-weight: bold;
            background: white;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        }

        .slot.empty {
            background: #e9ecef;
            color: #999;
            border-style: dashed;
        }

        .slot.filled {
            color: #33691e;
        }

        .slot.correct {
            background: #d4edda;
            border-color: #28a745;
            animation: pulse 0.5s;
        }

        .slot.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
            animation: shake 0.5s;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .numbers-container {
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            border: 3px solid;
        }

        .numbers-container h3 {
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.3em;
        }

        .numbers-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 10px;
            padding: 10px;
        }

        @media (max-width: 768px) {
            .numbers-grid {
                grid-template-columns: repeat(5, 1fr);
            }
        }

        @media (max-width: 480px) {
            .numbers-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .number-item {
            width: 50px;
            height: 50px;
            background: white;
            border: 3px solid;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            font-weight: bold;
            cursor: grab;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }

        .number-item:hover:not(.used) {
            transform: scale(1.1);
        }

        .number-item.used {
            opacity: 0.4;
            cursor: not-allowed;
            background: #e9ecef;
            transform: none;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        button {
            padding: 15px 25px;
            font-size: 1em;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
            min-width: 160px;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .check-btn { 
            background: linear-gradient(135deg, #4caf50 0%, #8bc34a 100%);
            color: white;
        }

        .next-btn { 
            background: linear-gradient(135deg, #2196f3 0%, #4facfe 100%);
            color: white;
        }

        .reset-btn { 
            background: linear-gradient(135deg, #ff9800 0%, #ffb74d 100%);
            color: white;
        }

        .prev-btn { 
            background: linear-gradient(135deg, #9e9e9e 0%, #bdbdbd 100%);
            color: white;
        }

        .reset-all-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff8e8e 100%);
            color: white;
            border: 3px solid #d32f2f;
            margin-top: 10px;
            padding: 10px 20px;
            font-size: 0.9em;
        }

        button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }

        button:disabled {
            background: #bdbdbd;
            cursor: not-allowed;
            transform: none;
        }

        .feedback {
            text-align: center;
            margin-top: 15px;
            padding: 15px;
            border-radius: 15px;
            font-weight: bold;
            display: none;
            font-size: 1.1em;
            animation: slideIn 0.5s;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .completion-screen {
            display: none;
            text-align: center;
            padding: 50px;
            background: linear-gradient(135deg, #fff9c4 0%, #fff 100%);
            border-radius: 20px;
            border: 5px solid #ffd166;
        }

        .score-display {
            font-size: 4em;
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            margin: 20px 0;
            animation: bounce 1s infinite alternate;
        }

        @keyframes bounce {
            from { transform: scale(1); }
            to { transform: scale(1.1); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üßÆ Desafio das Sequ√™ncias Num√©ricas</h1>
            <p>4 n√≠veis com 20 desafios √∫nicos cada - Cada n√∫mero resolve apenas UM desafio!</p>
            
            <div class="header-controls">
                <button class="reset-all-btn" onclick="resetEntireGame()">
                    üî• Zerar Todo o Jogo
                </button>
                <button class="reset-btn" onclick="showProgressSummary()">
                    üìä Ver Progresso Total
                </button>
            </div>
        </div>

        <div class="tabs-container">
            <div class="tab tab-1 active" data-tab="1" onclick="switchTab(1)">
                <span>üî¢</span> N√≠vel 1
            </div>
            <div class="tab tab-2" data-tab="2" onclick="switchTab(2)">
                <span>‚úèÔ∏è</span> N√≠vel 2
            </div>
            <div class="tab tab-3" data-tab="3" onclick="switchTab(3)">
                <span>üìö</span> N√≠vel 3
            </div>
            <div class="tab tab-4" data-tab="4" onclick="switchTab(4)">
                <span>üèÜ</span> N√≠vel 4
            </div>
        </div>

        <!-- Tab 1 Content -->
        <div class="tab-content tab-content-1 active" id="tab-content-1">
            <div class="game-stats">
                <div class="stat">
                    <div class="stat-value" id="score-1">0</div>
                    <div class="stat-label">‚≠ê Pontos</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="correct-1">0</div>
                    <div class="stat-label">‚úÖ Acertos</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="error-1">0</div>
                    <div class="stat-label">‚ùå Erros</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="screen-1">1/4</div>
                    <div class="stat-label">üì± Tela</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="progress-1">0%</div>
                    <div class="stat-label">üìä Progresso</div>
                </div>
            </div>

            <div class="screen-info" style="background: linear-gradient(135deg, #fff9c4 0%, #ffef9f 100%); border: 3px solid #ff9a00;">
                <h2 style="color: #996600;">N√≠vel 1 - Tela <span id="current-screen-1">1</span> de 4</h2>
                <p style="color: #996600; margin-bottom: 10px;">üî¢ Cada n√∫mero resolve apenas UM desafio nesta tela!</p>
                <div class="progress-container">
                    <div>Progresso do N√≠vel: <span id="completed-exercises-1">0</span>/20 desafios</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill-1"></div>
                    </div>
                </div>
            </div>

            <div class="exercises-container" id="exercises-1"></div>

            <div class="numbers-container" style="background: linear-gradient(135deg, #fff9c4 0%, #ffef9f 100%); border-color: #ff9a00;">
                <h3 style="color: #996600;">‚ú® N√∫meros √önicos para esta Tela ‚ú®</h3>
                <p style="text-align: center; color: #996600; margin-bottom: 10px; font-size: 0.9em;">
                    Cada n√∫mero resolve exatamente UM desafio
                </p>
                <div class="numbers-grid" id="numbers-1"></div>
            </div>

            <div class="controls">
                <button class="prev-btn" id="prev-btn-1" onclick="prevScreen(1)" disabled>‚óÄÔ∏è Tela Anterior</button>
                <button class="check-btn" id="check-btn-1" onclick="checkAnswers(1)" disabled>‚úÖ Verificar</button>
                <button class="next-btn" id="next-btn-1" onclick="nextScreen(1)" disabled>‚ñ∂Ô∏è Pr√≥xima Tela</button>
                <button class="reset-btn" onclick="resetCurrentScreen(1)">üîÑ Reiniciar Tela</button>
            </div>

            <div class="feedback" id="feedback-1" style="display: none;"></div>
        </div>

        <!-- Tab 2 Content -->
        <div class="tab-content tab-content-2" id="tab-content-2">
            <div class="game-stats">
                <div class="stat">
                    <div class="stat-value" id="score-2">0</div>
                    <div class="stat-label">‚≠ê Pontos</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="correct-2">0</div>
                    <div class="stat-label">‚úÖ Acertos</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="error-2">0</div>
                    <div class="stat-label">‚ùå Erros</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="screen-2">1/4</div>
                    <div class="stat-label">üì± Tela</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="progress-2">0%</div>
                    <div class="stat-label">üìä Progresso</div>
                </div>
            </div>

            <div class="screen-info" style="background: linear-gradient(135deg, #c8e6c9 0%, #a5d6a7 100%); border: 3px solid #4caf50;">
                <h2 style="color: #2e7d32;">N√≠vel 2 - Tela <span id="current-screen-2">1</span> de 4</h2>
                <p style="color: #2e7d32; margin-bottom: 10px;">‚úèÔ∏è Cada n√∫mero resolve apenas UM desafio nesta tela!</p>
                <div class="progress-container">
                    <div>Progresso do N√≠vel: <span id="completed-exercises-2">0</span>/20 desafios</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill-2"></div>
                    </div>
                </div>
            </div>

            <div class="exercises-container" id="exercises-2"></div>

            <div class="numbers-container" style="background: linear-gradient(135deg, #c8e6c9 0%, #a5d6a7 100%); border-color: #4caf50;">
                <h3 style="color: #2e7d32;">‚ú® N√∫meros √önicos para esta Tela ‚ú®</h3>
                <p style="text-align: center; color: #2e7d32; margin-bottom: 10px; font-size: 0.9em;">
                    Cada n√∫mero resolve exatamente UM desafio
                </p>
                <div class="numbers-grid" id="numbers-2"></div>
            </div>

            <div class="controls">
                <button class="prev-btn" id="prev-btn-2" onclick="prevScreen(2)" disabled>‚óÄÔ∏è Tela Anterior</button>
                <button class="check-btn" id="check-btn-2" onclick="checkAnswers(2)" disabled>‚úÖ Verificar</button>
                <button class="next-btn" id="next-btn-2" onclick="nextScreen(2)" disabled>‚ñ∂Ô∏è Pr√≥xima Tela</button>
                <button class="reset-btn" onclick="resetCurrentScreen(2)">üîÑ Reiniciar Tela</button>
            </div>

            <div class="feedback" id="feedback-2" style="display: none;"></div>
        </div>

        <!-- Tab 3 Content -->
        <div class="tab-content tab-content-3" id="tab-content-3">
            <div class="game-stats">
                <div class="stat">
                    <div class="stat-value" id="score-3">0</div>
                    <div class="stat-label">‚≠ê Pontos</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="correct-3">0</div>
                    <div class="stat-label">‚úÖ Acertos</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="error-3">0</div>
                    <div class="stat-label">‚ùå Erros</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="screen-3">1/4</div>
                    <div class="stat-label">üì± Tela</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="progress-3">0%</div>
                    <div class="stat-label">üìä Progresso</div>
                </div>
            </div>

            <div class="screen-info" style="background: linear-gradient(135deg, #bbdefb 0%, #90caf9 100%); border: 3px solid #2196f3;">
                <h2 style="color: #1565c0;">N√≠vel 3 - Tela <span id="current-screen-3">1</span> de 4</h2>
                <p style="color: #1565c0; margin-bottom: 10px;">üìö Cada n√∫mero resolve apenas UM desafio nesta tela!</p>
                <div class="progress-container">
                    <div>Progresso do N√≠vel: <span id="completed-exercises-3">0</span>/20 desafios</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill-3"></div>
                    </div>
                </div>
            </div>

            <div class="exercises-container" id="exercises-3"></div>

            <div class="numbers-container" style="background: linear-gradient(135deg, #bbdefb 0%, #90caf9 100%); border-color: #2196f3;">
                <h3 style="color: #1565c0;">‚ú® N√∫meros √önicos para esta Tela ‚ú®</h3>
                <p style="text-align: center; color: #1565c0; margin-bottom: 10px; font-size: 0.9em;">
                    Cada n√∫mero resolve exatamente UM desafio
                </p>
                <div class="numbers-grid" id="numbers-3"></div>
            </div>

            <div class="controls">
                <button class="prev-btn" id="prev-btn-3" onclick="prevScreen(3)" disabled>‚óÄÔ∏è Tela Anterior</button>
                <button class="check-btn" id="check-btn-3" onclick="checkAnswers(3)" disabled>‚úÖ Verificar</button>
                <button class="next-btn" id="next-btn-3" onclick="nextScreen(3)" disabled>‚ñ∂Ô∏è Pr√≥xima Tela</button>
                <button class="reset-btn" onclick="resetCurrentScreen(3)">üîÑ Reiniciar Tela</button>
            </div>

            <div class="feedback" id="feedback-3" style="display: none;"></div>
        </div>

        <!-- Tab 4 Content -->
        <div class="tab-content tab-content-4" id="tab-content-4">
            <div class="game-stats">
                <div class="stat">
                    <div class="stat-value" id="score-4">0</div>
                    <div class="stat-label">‚≠ê Pontos</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="correct-4">0</div>
                    <div class="stat-label">‚úÖ Acertos</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="error-4">0</div>
                    <div class="stat-label">‚ùå Erros</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="screen-4">1/4</div>
                    <div class="stat-label">üì± Tela</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="progress-4">0%</div>
                    <div class="stat-label">üìä Progresso</div>
                </div>
            </div>

            <div class="screen-info" style="background: linear-gradient(135deg, #e1bee7 0%, #ce93d8 100%); border: 3px solid #9c27b0;">
                <h2 style="color: #6a1b9a;">N√≠vel 4 - Tela <span id="current-screen-4">1</span> de 4</h2>
                <p style="color: #6a1b9a; margin-bottom: 10px;">üèÜ Cada n√∫mero resolve apenas UM desafio nesta tela!</p>
                <div class="progress-container">
                    <div>Progresso do N√≠vel: <span id="completed-exercises-4">0</span>/20 desafios</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill-4"></div>
                    </div>
                </div>
            </div>

            <div class="exercises-container" id="exercises-4"></div>

            <div class="numbers-container" style="background: linear-gradient(135deg, #e1bee7 0%, #ce93d8 100%); border-color: #9c27b0;">
                <h3 style="color: #6a1b9a;">‚ú® N√∫meros √önicos para esta Tela ‚ú®</h3>
                <p style="text-align: center; color: #6a1b9a; margin-bottom: 10px; font-size: 0.9em;">
                    Cada n√∫mero resolve exatamente UM desafio
                </p>
                <div class="numbers-grid" id="numbers-4"></div>
            </div>

            <div class="controls">
                <button class="prev-btn" id="prev-btn-4" onclick="prevScreen(4)" disabled>‚óÄÔ∏è Tela Anterior</button>
                <button class="check-btn" id="check-btn-4" onclick="checkAnswers(4)" disabled>‚úÖ Verificar</button>
                <button class="next-btn" id="next-btn-4" onclick="nextScreen(4)" disabled>‚ñ∂Ô∏è Pr√≥xima Tela</button>
                <button class="reset-btn" onclick="resetCurrentScreen(4)">üîÑ Reiniciar Tela</button>
            </div>

            <div class="feedback" id="feedback-4" style="display: none;"></div>
        </div>
    </div>

    <!-- Completion Screens para cada n√≠vel -->
    <div class="container completion-screen" id="completion-screen-1" style="display: none;">
        <h2>üèÜ N√≠vel 1 Conclu√≠do! üèÜ</h2>
        <p>Voc√™ completou todos os 20 desafios do N√≠vel 1!</p>
        <div class="score-display" id="final-score-1">0</div>
        <div style="margin-top: 30px;">
            <button class="reset-btn" onclick="restartLevel(1)" style="font-size: 1.2em; padding: 20px 40px;">
                üîÑ Jogar Novamente
            </button>
            <button class="next-btn" onclick="switchTab(2)" style="font-size: 1.2em; padding: 20px 40px; margin-left: 20px;">
                ‚ñ∂Ô∏è Ir para N√≠vel 2
            </button>
        </div>
    </div>

    <div class="container completion-screen" id="completion-screen-2" style="display: none;">
        <h2>üèÜ N√≠vel 2 Conclu√≠do! üèÜ</h2>
        <p>Voc√™ completou todos os 20 desafios do N√≠vel 2!</p>
        <div class="score-display" id="final-score-2">0</div>
        <div style="margin-top: 30px;">
            <button class="reset-btn" onclick="restartLevel(2)" style="font-size: 1.2em; padding: 20px 40px;">
                üîÑ Jogar Novamente
            </button>
            <button class="next-btn" onclick="switchTab(3)" style="font-size: 1.2em; padding: 20px 40px; margin-left: 20px;">
                ‚ñ∂Ô∏è Ir para N√≠vel 3
            </button>
        </div>
    </div>

    <div class="container completion-screen" id="completion-screen-3" style="display: none;">
        <h2>üèÜ N√≠vel 3 Conclu√≠do! üèÜ</h2>
        <p>Voc√™ completou todos os 20 desafios do N√≠vel 3!</p>
        <div class="score-display" id="final-score-3">0</div>
        <div style="margin-top: 30px;">
            <button class="reset-btn" onclick="restartLevel(3)" style="font-size: 1.2em; padding: 20px 40px;">
                üîÑ Jogar Novamente
            </button>
            <button class="next-btn" onclick="switchTab(4)" style="font-size: 1.2em; padding: 20px 40px; margin-left: 20px;">
                ‚ñ∂Ô∏è Ir para N√≠vel 4
            </button>
        </div>
    </div>

    <div class="container completion-screen" id="completion-screen-4" style="display: none;">
        <h2>üèÜ N√≠vel 4 Conclu√≠do! üèÜ</h2>
        <p>Parab√©ns! Voc√™ completou TODOS os 80 desafios do jogo! üéâ</p>
        <div class="score-display" id="final-score-4">0</div>
        <p style="font-size: 1.2em; margin: 20px 0;">Pontua√ß√£o Total: <span id="total-score">0</span></p>
        <div style="margin-top: 30px;">
            <button class="reset-btn" onclick="restartAllLevels()" style="font-size: 1.2em; padding: 20px 40px;">
                üîÑ Jogar Todos Novamente
            </button>
            <button class="next-btn" onclick="switchTab(1)" style="font-size: 1.2em; padding: 20px 40px; margin-left: 20px;">
                üè† Voltar ao In√≠cio
            </button>
        </div>
    </div>

    <!-- Modal para progresso total -->
    <div class="container completion-screen" id="progress-summary" style="display: none; max-width: 800px;">
        <h2>üìä Progresso Total do Jogo</h2>
        
        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin: 30px 0;">
            <div class="stat" style="background: linear-gradient(135deg, #fff9c4 0%, #ffef9f 100%);">
                <div class="stat-value" id="total-level-1">0/20</div>
                <div class="stat-label">N√≠vel 1</div>
            </div>
            <div class="stat" style="background: linear-gradient(135deg, #c8e6c9 0%, #a5d6a7 100%);">
                <div class="stat-value" id="total-level-2">0/20</div>
                <div class="stat-label">N√≠vel 2</div>
            </div>
            <div class="stat" style="background: linear-gradient(135deg, #bbdefb 0%, #90caf9 100%);">
                <div class="stat-value" id="total-level-3">0/20</div>
                <div class="stat-label">N√≠vel 3</div>
            </div>
            <div class="stat" style="background: linear-gradient(135deg, #e1bee7 0%, #ce93d8 100%);">
                <div class="stat-value" id="total-level-4">0/20</div>
                <div class="stat-label">N√≠vel 4</div>
            </div>
        </div>
        
        <div style="background: #e3f2fd; padding: 20px; border-radius: 15px; margin: 20px 0;">
            <h3>üèÜ Pontua√ß√£o Total: <span id="grand-total-score">0</span> pontos</h3>
            <p>Desafios completados: <span id="total-completed">0</span>/80</p>
            <div class="progress-bar" style="margin-top: 10px;">
                <div class="progress-fill" id="total-progress-fill" style="width: 0%"></div>
            </div>
        </div>
        
        <div style="margin-top: 30px;">
            <button class="reset-btn" onclick="hideProgressSummary()" style="font-size: 1em; padding: 15px 30px;">
                ‚Ü©Ô∏è Voltar ao Jogo
            </button>
            <button class="reset-all-btn" onclick="resetEntireGameConfirm()" style="font-size: 1em; padding: 15px 30px; margin-left: 20px;">
                üî• Zerar Tudo
            </button>
        </div>
    </div>

    <script>
        // Configura√ß√µes com garantia de n√∫meros √∫nicos
        const levels = {
            1: {
                name: "N√≠vel 1",
                totalScreens: 4,
                exercisesPerScreen: 5,
                maxNumber: 50,
                numbersPerScreen: 30,
                sequenceLength: 5,
                minStep: 1,
                maxStep: 3,
                pointsPerScreen: 25,
                colorScheme: { primary: "#ff9a00", secondary: "#fff9c4", text: "#996600" }
            },
            2: {
                name: "N√≠vel 2",
                totalScreens: 4,
                exercisesPerScreen: 5,
                maxNumber: 150,
                numbersPerScreen: 35,
                sequenceLength: 5,
                minStep: 2,
                maxStep: 5,
                pointsPerScreen: 30,
                colorScheme: { primary: "#4caf50", secondary: "#c8e6c9", text: "#2e7d32" }
            },
            3: {
                name: "N√≠vel 3",
                totalScreens: 4,
                exercisesPerScreen: 5,
                maxNumber: 300,
                numbersPerScreen: 40,
                sequenceLength: 5,
                minStep: 3,
                maxStep: 8,
                pointsPerScreen: 35,
                colorScheme: { primary: "#2196f3", secondary: "#bbdefb", text: "#1565c0" }
            },
            4: {
                name: "N√≠vel 4",
                totalScreens: 4,
                exercisesPerScreen: 5,
                maxNumber: 500,
                numbersPerScreen: 45,
                sequenceLength: 5,
                minStep: 4,
                maxStep: 12,
                pointsPerScreen: 40,
                colorScheme: { primary: "#9c27b0", secondary: "#e1bee7", text: "#6a1b9a" }
            }
        };

        // Estado do jogo
        let gameStates = {
            1: { currentScreen: 0, score: 0, correctAnswers: 0, errorCount: 0, screens: [], draggedNumber: null },
            2: { currentScreen: 0, score: 0, correctAnswers: 0, errorCount: 0, screens: [], draggedNumber: null },
            3: { currentScreen: 0, score: 0, correctAnswers: 0, errorCount: 0, screens: [], draggedNumber: null },
            4: { currentScreen: 0, score: 0, correctAnswers: 0, errorCount: 0, screens: [], draggedNumber: null }
        };

        let currentTab = 1;

        // Inicializar
        function initAllLevels() {
            for (let level = 1; level <= 4; level++) {
                generateLevelScreens(level);
                loadScreen(level, 0);
            }
            
            // Garantir que apenas o N√≠vel 1 seja vis√≠vel inicialmente
            document.getElementById('tab-content-1').style.display = 'block';
            document.getElementById('tab-content-1').classList.add('active');
            
            for (let i = 2; i <= 4; i++) {
                document.getElementById(`tab-content-${i}`).style.display = 'none';
                document.getElementById(`tab-content-${i}`).classList.remove('active');
            }
            
            updateStats(1);
            updateButtons(1);
        }

        // Gerar telas com n√∫meros √∫nicos para cada desafio
        function generateLevelScreens(level) {
            const config = levels[level];
            const screens = [];
            
            for (let screenIndex = 0; screenIndex < config.totalScreens; screenIndex++) {
                const screen = {
                    exercises: [],
                    numbers: [],
                    completed: false,
                    userAnswers: {},
                    screenNumber: screenIndex + 1,
                    numberToExerciseMap: new Map(),
                    allNumbersUsed: new Set()
                };
                
                // Gerar exerc√≠cios com n√∫meros completamente √∫nicos
                for (let exIndex = 0; exIndex < config.exercisesPerScreen; exIndex++) {
                    let sequenceValid = false;
                    let attempts = 0;
                    let fullSequence = [];
                    let step = 0;
                    let startNum = 0;
                    let missingPosition = 0;
                    let missingNumber = 0;
                    
                    while (!sequenceValid && attempts < 50) {
                        attempts++;
                        sequenceValid = true;
                        
                        step = Math.floor(Math.random() * (config.maxStep - config.minStep + 1)) + config.minStep;
                        const maxStart = config.maxNumber - (step * (config.sequenceLength - 1));
                        startNum = Math.floor(Math.random() * Math.max(1, maxStart)) + 1;
                        
                        fullSequence = [];
                        for (let i = 0; i < config.sequenceLength; i++) {
                            fullSequence.push(startNum + (step * i));
                        }
                        
                        for (const num of fullSequence) {
                            if (screen.allNumbersUsed.has(num)) {
                                sequenceValid = false;
                                break;
                            }
                        }
                        
                        if (sequenceValid) {
                            if (screenIndex === 0) missingPosition = 2;
                            else if (screenIndex === 1) missingPosition = Math.random() > 0.5 ? 1 : 3;
                            else missingPosition = Math.floor(Math.random() * (config.sequenceLength - 1)) + 1;
                            
                            missingNumber = fullSequence[missingPosition];
                        }
                    }
                    
                    for (const num of fullSequence) {
                        screen.allNumbersUsed.add(num);
                    }
                    
                    const sequenceWithGap = [...fullSequence];
                    sequenceWithGap[missingPosition] = null;
                    
                    const exercise = {
                        id: `l${level}s${screenIndex}e${exIndex}`,
                        fullSequence: fullSequence,
                        displayedSequence: sequenceWithGap,
                        missingPosition: missingPosition,
                        missingNumber: missingNumber,
                        step: step,
                        userAnswer: null,
                        isCorrect: false
                    };
                    
                    screen.exercises.push(exercise);
                    screen.userAnswers[exercise.id] = null;
                    screen.numberToExerciseMap.set(missingNumber, exercise.id);
                }
                
                const missingNumbers = Array.from(screen.numberToExerciseMap.keys());
                const additionalNumbers = new Set();
                const totalNumbersNeeded = config.numbersPerScreen - config.exercisesPerScreen;
                
                while (additionalNumbers.size < totalNumbersNeeded) {
                    const num = Math.floor(Math.random() * config.maxNumber) + 1;
                    if (!screen.allNumbersUsed.has(num) && !additionalNumbers.has(num)) {
                        additionalNumbers.add(num);
                        screen.allNumbersUsed.add(num);
                    }
                }
                
                screen.numbers = [...missingNumbers, ...Array.from(additionalNumbers)];
                shuffleArray(screen.numbers);
                
                screens.push(screen);
            }
            
            gameStates[level].screens = screens;
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function loadScreen(level, screenIndex) {
            const state = gameStates[level];
            const config = levels[level];
            const screen = state.screens[screenIndex];
            
            state.currentScreen = screenIndex;
            
            document.getElementById(`current-screen-${level}`).textContent = screenIndex + 1;
            document.getElementById(`screen-${level}`).textContent = `${screenIndex + 1}/${config.totalScreens}`;
            
            document.getElementById(`prev-btn-${level}`).disabled = screenIndex === 0;
            document.getElementById(`next-btn-${level}`).disabled = screenIndex === config.totalScreens - 1;
            
            const exercisesContainer = document.getElementById(`exercises-${level}`);
            exercisesContainer.innerHTML = '';
            
            screen.exercises.forEach((exercise, index) => {
                const exerciseDiv = document.createElement('div');
                exerciseDiv.className = 'exercise';
                exerciseDiv.style.borderColor = config.colorScheme.primary;
                exerciseDiv.innerHTML = `
                    <h4 style="margin-bottom: 10px; color: ${config.colorScheme.text};">Desafio ${index + 1}</h4>
                    <div class="sequence-slots">
                        ${exercise.displayedSequence.map((num, pos) => `
                            <div class="slot ${num === null ? 'empty' : 'filled'}" 
                                 data-exercise="${exercise.id}" 
                                 data-position="${pos}"
                                 onclick="handleSlotClick(${level}, '${exercise.id}', ${pos})">
                                ${num !== null ? num : '?'}
                            </div>
                        `).join('')}
                    </div>
                `;
                exercisesContainer.appendChild(exerciseDiv);
            });
            
            const numbersContainer = document.getElementById(`numbers-${level}`);
            numbersContainer.innerHTML = '';
            
            screen.numbers.forEach(num => {
                const numberDiv = document.createElement('div');
                numberDiv.className = 'number-item';
                numberDiv.textContent = num;
                numberDiv.draggable = true;
                numberDiv.style.borderColor = config.colorScheme.primary;
                
                const exerciseId = screen.numberToExerciseMap.get(num);
                if (exerciseId) {
                    const exercise = screen.exercises.find(e => e.id === exerciseId);
                    if (exercise && exercise.userAnswer === num) {
                        numberDiv.classList.add('used');
                    }
                }
                
                numberDiv.addEventListener('dragstart', (e) => {
                    gameStates[level].draggedNumber = {
                        number: num,
                        element: numberDiv
                    };
                    e.dataTransfer.setData('text/plain', num);
                    numberDiv.style.opacity = '0.5';
                });
                
                numberDiv.addEventListener('dragend', () => {
                    numberDiv.style.opacity = '1';
                    gameStates[level].draggedNumber = null;
                });
                
                numberDiv.addEventListener('click', () => handleNumberClick(level, num));
                
                numbersContainer.appendChild(numberDiv);
            });
            
            setupDropZones(level);
            updateProgress(level);
            updateStats(level);
            updateButtons(level);
        }

        function setupDropZones(level) {
            const state = gameStates[level];
            const screen = state.screens[state.currentScreen];
            
            screen.exercises.forEach(exercise => {
                const slots = document.querySelectorAll(`.slot.empty[data-exercise="${exercise.id}"]`);
                slots.forEach(slot => {
                    slot.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        slot.style.backgroundColor = '#e3f2fd';
                    });
                    
                    slot.addEventListener('dragleave', () => {
                        slot.style.backgroundColor = '';
                    });
                    
                    slot.addEventListener('drop', (e) => {
                        e.preventDefault();
                        slot.style.backgroundColor = '';
                        
                        const number = parseInt(e.dataTransfer.getData('text/plain'));
                        if (!isNaN(number)) {
                            placeNumberInSlot(level, exercise.id, number);
                        }
                    });
                });
            });
        }

        function placeNumberInSlot(level, exerciseId, number) {
            const state = gameStates[level];
            const screen = state.screens[state.currentScreen];
            const exercise = screen.exercises.find(e => e.id === exerciseId);
            
            if (!exercise) return;
            
            const isNumberAlreadyUsed = screen.exercises.some(e => 
                e.id !== exerciseId && e.userAnswer === number
            );
            
            const isNumberFixedInSequence = exercise.fullSequence.includes(number) && 
                                           number !== exercise.missingNumber;
            
            if (isNumberAlreadyUsed) {
                showFeedback(level, "‚ùå Este n√∫mero j√° foi usado em outro desafio!", false);
                return;
            }
            
            if (isNumberFixedInSequence) {
                showFeedback(level, `‚ùå O n√∫mero ${number} j√° est√° na sequ√™ncia!`, false);
                return;
            }
            
            exercise.userAnswer = number;
            screen.userAnswers[exerciseId] = number;
            
            const slot = document.querySelector(`.slot.empty[data-exercise="${exerciseId}"][data-position="${exercise.missingPosition}"]`);
            if (slot) {
                slot.textContent = number;
                slot.classList.remove('empty');
                slot.classList.add('filled');
                slot.style.backgroundColor = '#e8f5e8';
            }
            
            const numberElement = Array.from(document.querySelectorAll(`#numbers-${level} .number-item`))
                .find(el => parseInt(el.textContent) === number);
            if (numberElement) {
                numberElement.classList.add('used');
                numberElement.style.opacity = '0.5';
            }
            
            showFeedback(level, `‚úÖ N√∫mero ${number} colocado!`, true);
            updateButtons(level);
        }

        function removeNumberFromSlot(level, exerciseId, number) {
            const state = gameStates[level];
            const screen = state.screens[state.currentScreen];
            const exercise = screen.exercises.find(e => e.id === exerciseId);
            
            if (!exercise) return;
            
            exercise.userAnswer = null;
            screen.userAnswers[exerciseId] = null;
            
            const slot = document.querySelector(`.slot.filled[data-exercise="${exerciseId}"][data-position="${exercise.missingPosition}"]`);
            if (slot) {
                slot.textContent = '?';
                slot.classList.remove('filled');
                slot.classList.add('empty');
                slot.style.backgroundColor = '';
            }
            
            const numberElement = Array.from(document.querySelectorAll(`#numbers-${level} .number-item`))
                .find(el => parseInt(el.textContent) === number);
            if (numberElement) {
                numberElement.classList.remove('used');
                numberElement.style.opacity = '1';
            }
            
            showFeedback(level, `üóëÔ∏è N√∫mero ${number} removido!`, true);
            updateButtons(level);
        }

        function checkAnswers(level) {
            const state = gameStates[level];
            const screen = state.screens[state.currentScreen];
            const config = levels[level];
            let allCorrect = true;
            let correctCount = 0;
            
            screen.exercises.forEach(exercise => {
                const isCorrect = exercise.userAnswer === exercise.missingNumber;
                exercise.isCorrect = isCorrect;
                
                const slot = document.querySelector(`.slot[data-exercise="${exercise.id}"][data-position="${exercise.missingPosition}"]`);
                if (slot) {
                    slot.classList.remove('correct', 'incorrect');
                    slot.classList.add(isCorrect ? 'correct' : 'incorrect');
                }
                
                if (isCorrect) {
                    correctCount++;
                } else {
                    allCorrect = false;
                }
            });
            
            if (allCorrect && !screen.completed) {
                screen.completed = true;
                state.score += config.pointsPerScreen;
                state.correctAnswers += correctCount;
                
                showFeedback(level, `üéâ Tela ${screen.screenNumber} completa! +${config.pointsPerScreen} pontos!`, true);
                
                if (state.currentScreen < config.totalScreens - 1) {
                    setTimeout(() => {
                        nextScreen(level);
                    }, 1500);
                }
            } else if (allCorrect) {
                showFeedback(level, "‚úÖ Tela j√° completada!", true);
            } else {
                state.errorCount += screen.exercises.length - correctCount;
                showFeedback(level, `‚ùå ${correctCount}/5 corretos. Continue tentando!`, false);
            }
            
            updateStats(level);
            updateProgress(level);
            updateButtons(level);
            
            if (checkLevelCompletion(level)) {
                showLevelCompletion(level);
            }
        }

        function updateButtons(level) {
            const state = gameStates[level];
            const config = levels[level];
            const screen = state.screens[state.currentScreen];
            
            const allExercisesFilled = screen.exercises.every(exercise => exercise.userAnswer !== null);
            
            document.getElementById(`check-btn-${level}`).disabled = !allExercisesFilled;
            document.getElementById(`next-btn-${level}`).disabled = !screen.completed || state.currentScreen === config.totalScreens - 1;
            document.getElementById(`prev-btn-${level}`).disabled = state.currentScreen === 0;
        }

        function checkLevelCompletion(level) {
            const state = gameStates[level];
            const config = levels[level];
            
            const allScreensCompleted = state.screens.every(screen => screen.completed);
            const totalExercises = config.exercisesPerScreen * config.totalScreens;
            
            return allScreensCompleted && state.correctAnswers >= totalExercises;
        }

        function showLevelCompletion(level) {
            const state = gameStates[level];
            
            // Esconder o conte√∫do normal da aba
            document.getElementById(`tab-content-${level}`).style.display = 'none';
            
            // Mostrar tela de conclus√£o
            const completionScreen = document.getElementById(`completion-screen-${level}`);
            completionScreen.style.display = 'block';
            document.getElementById(`final-score-${level}`).textContent = state.score;
            
            if (level === 4) {
                const totalScore = gameStates[1].score + gameStates[2].score + 
                                 gameStates[3].score + gameStates[4].score;
                document.getElementById('total-score').textContent = totalScore;
            }
            
            const tab = document.querySelector(`.tab-${level}`);
            tab.innerHTML = `<span>üèÜ</span> N√≠vel ${level} Conclu√≠do!`;
        }

        function switchTab(tabNumber) {
            currentTab = tabNumber;
            
            // Esconder todas as telas de conclus√£o
            for (let i = 1; i <= 4; i++) {
                document.getElementById(`completion-screen-${i}`).style.display = 'none';
            }
            
            // Esconder modal de progresso
            document.getElementById('progress-summary').style.display = 'none';
            
            // Atualizar apar√™ncia das ABAS
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Esconder todo o conte√∫do das abas
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
                content.style.display = 'none';
            });
            
            // Mostrar apenas a aba selecionada
            document.querySelector(`.tab-${tabNumber}`).classList.add('active');
            
            const state = gameStates[tabNumber];
            const config = levels[tabNumber];
            const totalExercises = config.exercisesPerScreen * config.totalScreens;
            
            if (state.correctAnswers >= totalExercises) {
                // Se o n√≠vel foi conclu√≠do, mostrar tela de conclus√£o
                document.getElementById(`completion-screen-${tabNumber}`).style.display = 'block';
            } else {
                // Se n√£o, mostrar o conte√∫do normal do jogo
                const selectedContent = document.getElementById(`tab-content-${tabNumber}`);
                selectedContent.classList.add('active');
                selectedContent.style.display = 'block';
            }
            
            updateStats(tabNumber);
            updateButtons(tabNumber);
        }

        function nextScreen(level) {
            const state = gameStates[level];
            const screen = state.screens[state.currentScreen];
            
            if (!screen.completed) {
                showFeedback(level, "‚ùå Complete esta tela antes de avan√ßar!", false);
                return;
            }
            
            if (state.currentScreen < levels[level].totalScreens - 1) {
                loadScreen(level, state.currentScreen + 1);
                showFeedback(level, `üì± Indo para tela ${state.currentScreen + 2}...`, true);
            }
        }

        function prevScreen(level) {
            const state = gameStates[level];
            if (state.currentScreen > 0) {
                loadScreen(level, state.currentScreen - 1);
                showFeedback(level, `üì± Voltando para tela ${state.currentScreen}...`, true);
            }
        }

        function resetCurrentScreen(level) {
            const state = gameStates[level];
            const screen = state.screens[state.currentScreen];
            
            screen.exercises.forEach(exercise => {
                exercise.userAnswer = null;
                exercise.isCorrect = false;
                screen.userAnswers[exercise.id] = null;
            });
            
            loadScreen(level, state.currentScreen);
            
            showFeedback(level, "üîÑ Tela reiniciada! Tente novamente.", true);
        }

        function restartLevel(level) {
            gameStates[level] = {
                currentScreen: 0,
                score: 0,
                correctAnswers: 0,
                errorCount: 0,
                screens: [],
                draggedNumber: null
            };
            
            generateLevelScreens(level);
            loadScreen(level, 0);
            
            document.getElementById(`completion-screen-${level}`).style.display = 'none';
            document.getElementById(`tab-content-${level}`).style.display = 'block';
            
            const tab = document.querySelector(`.tab-${level}`);
            tab.innerHTML = `<span>${level === 1 ? 'üî¢' : level === 2 ? '‚úèÔ∏è' : level === 3 ? 'üìö' : 'üèÜ'}</span> N√≠vel ${level}`;
            
            showFeedback(level, `üéÆ N√≠vel ${level} reiniciado!`, true);
        }

        function resetEntireGame() {
            if (confirm("‚ö†Ô∏è ATEN√á√ÉO!\n\nVoc√™ est√° prestes a ZERAR TODO O JOGO.\nIsso ir√°:\n‚Ä¢ Apagar todo o seu progresso\n‚Ä¢ Reiniciar todos os n√≠veis\n‚Ä¢ Zerar todas as pontua√ß√µes\n\nTem certeza que deseja continuar?")) {
                resetEntireGameConfirm();
            }
        }

        function resetEntireGameConfirm() {
            for (let level = 1; level <= 4; level++) {
                gameStates[level] = {
                    currentScreen: 0,
                    score: 0,
                    correctAnswers: 0,
                    errorCount: 0,
                    screens: [],
                    draggedNumber: null
                };
                generateLevelScreens(level);
                loadScreen(level, 0);
                
                const tab = document.querySelector(`.tab-${level}`);
                tab.innerHTML = `<span>${level === 1 ? 'üî¢' : level === 2 ? '‚úèÔ∏è' : level === 3 ? 'üìö' : 'üèÜ'}</span> N√≠vel ${level}`;
                
                document.getElementById(`completion-screen-${level}`).style.display = 'none';
                document.getElementById(`tab-content-${level}`).style.display = 'none';
            }
            
            document.getElementById('progress-summary').style.display = 'none';
            
            // Mostrar apenas o N√≠vel 1
            document.getElementById('tab-content-1').style.display = 'block';
            document.getElementById('tab-content-1').classList.add('active');
            
            // Atualizar tabs
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector('.tab-1').classList.add('active');
            
            showFeedback(1, "üîÑ TODO O JOGO reiniciado! Todos os n√≠veis zerados.", true);
        }

        function restartAllLevels() {
            resetEntireGameConfirm();
        }

        function showProgressSummary() {
            let totalScore = 0;
            let totalCompleted = 0;
            const totalExercises = 80;
            
            for (let level = 1; level <= 4; level++) {
                const state = gameStates[level];
                totalScore += state.score;
                totalCompleted += state.correctAnswers;
                
                document.getElementById(`total-level-${level}`).textContent = 
                    `${state.correctAnswers}/20`;
            }
            
            document.getElementById('grand-total-score').textContent = totalScore;
            document.getElementById('total-completed').textContent = totalCompleted;
            
            const totalProgress = (totalCompleted / totalExercises) * 100;
            document.getElementById('total-progress-fill').style.width = `${totalProgress}%`;
            
            document.getElementById('progress-summary').style.display = 'block';
            
            for (let i = 1; i <= 4; i++) {
                document.getElementById(`tab-content-${i}`).style.display = 'none';
                document.getElementById(`completion-screen-${i}`).style.display = 'none';
            }
        }

        function hideProgressSummary() {
            document.getElementById('progress-summary').style.display = 'none';
            
            // Restaurar a tab atual
            const state = gameStates[currentTab];
            const config = levels[currentTab];
            const totalExercises = config.exercisesPerScreen * config.totalScreens;
            
            if (state.correctAnswers >= totalExercises) {
                document.getElementById(`completion-screen-${currentTab}`).style.display = 'block';
                document.getElementById(`tab-content-${currentTab}`).style.display = 'none';
            } else {
                document.getElementById(`tab-content-${currentTab}`).style.display = 'block';
                document.getElementById(`tab-content-${currentTab}`).classList.add('active');
            }
        }

        function updateStats(level) {
            const state = gameStates[level];
            const config = levels[level];
            const totalExercises = config.exercisesPerScreen * config.totalScreens;
            const progressPercentage = Math.min(100, Math.floor((state.correctAnswers / totalExercises) * 100));
            
            document.getElementById(`score-${level}`).textContent = state.score;
            document.getElementById(`correct-${level}`).textContent = state.correctAnswers;
            document.getElementById(`error-${level}`).textContent = state.errorCount;
            document.getElementById(`progress-${level}`).textContent = `${progressPercentage}%`;
            document.getElementById(`completed-exercises-${level}`).textContent = state.correctAnswers;
            
            const progressFill = document.getElementById(`progress-fill-${level}`);
            if (progressFill) {
                progressFill.style.width = `${progressPercentage}%`;
            }
        }

        function updateProgress(level) {
            const state = gameStates[level];
            const totalExercises = levels[level].exercisesPerScreen * levels[level].totalScreens;
            const progress = Math.min(100, (state.correctAnswers / totalExercises) * 100);
            
            document.getElementById(`progress-${level}`).textContent = `${Math.round(progress)}%`;
            document.getElementById(`completed-exercises-${level}`).textContent = state.correctAnswers;
            
            const progressFill = document.getElementById(`progress-fill-${level}`);
            if (progressFill) {
                progressFill.style.width = `${progress}%`;
            }
        }

        function showFeedback(level, message, isPositive) {
            const feedback = document.getElementById(`feedback-${level}`);
            feedback.textContent = message;
            feedback.style.display = 'block';
            feedback.style.backgroundColor = isPositive ? '#d4edda' : '#f8d7da';
            feedback.style.color = isPositive ? '#155724' : '#721c24';
            feedback.style.border = `2px solid ${isPositive ? '#c3e6cb' : '#f5c6cb'}`;
            
            setTimeout(() => {
                feedback.style.display = 'none';
            }, 3000);
        }

        function handleNumberClick(level, number) {
            const state = gameStates[level];
            state.draggedNumber = { number: number };
            
            const numberElement = Array.from(document.querySelectorAll(`#numbers-${level} .number-item`))
                .find(el => parseInt(el.textContent) === number);
            
            if (numberElement && !numberElement.classList.contains('used')) {
                numberElement.style.transform = 'scale(1.2)';
                numberElement.style.boxShadow = '0 0 15px rgba(0,0,0,0.3)';
                setTimeout(() => {
                    numberElement.style.transform = '';
                    numberElement.style.boxShadow = '';
                }, 300);
                
                showFeedback(level, `üì± Clique em um "?" para colocar o n√∫mero ${number}`, true);
            }
        }

        function handleSlotClick(level, exerciseId, position) {
            const state = gameStates[level];
            const screen = state.screens[state.currentScreen];
            const exercise = screen.exercises.find(e => e.id === exerciseId);
            
            if (!exercise || position !== exercise.missingPosition) return;
            
            if (exercise.userAnswer !== null) {
                removeNumberFromSlot(level, exerciseId, exercise.userAnswer);
            } else if (state.draggedNumber) {
                placeNumberInSlot(level, exerciseId, state.draggedNumber.number);
            } else {
                showFeedback(level, "üì± Primeiro selecione um n√∫mero da lista abaixo", false);
            }
        }

        window.addEventListener('DOMContentLoaded', () => {
            initAllLevels();
            
            document.addEventListener('dragover', (e) => {
                e.preventDefault();
            });
            
            document.addEventListener('drop', (e) => {
                e.preventDefault();
            });
        });
    </script>
</body>
</html>
